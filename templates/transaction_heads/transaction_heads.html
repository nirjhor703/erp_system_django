{% extends 'base.html' %}
{% load static %}
{% block content %}

<div class="d-flex justify-content-between mb-3">
    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addModal">+ Add Transaction Head</button>
    <input class="form-control w-25" placeholder="Search...">
</div>

<h4 class="text-center mb-3">Transaction Head Details</h4>

<table class="table table-bordered">
<thead>
<tr>
<th>SL</th><th>Transaction Groupe</th><th>Name</th><th>MRP</th><th>Company</th><th>Action</th>
</tr>
</thead>
<tbody>
{% for h in heads %}
<tr id="row{{h.id}}">
<td>{{forloop.counter}}</td>
<td>{{h.groupe.tran_groupe_name}}</td>
<td>{{h.tran_head_name}}</td>
<td>{{h.mrp}}</td>
<td>{{h.company.company_id}}</td>
<td>
<button class="btn btn-warning editBtn" data-id="{{h.id}}">Edit</button>
<button class="btn btn-danger deleteBtn" data-id="{{h.id}}">Delete</button>
</td>
</tr>
{% endfor %}
</tbody>
</table>

<!-- ADD MODAL -->
<div class="modal fade" id="addModal">
<div class="modal-dialog modal-lg"><div class="modal-content">
<form id="addForm">{% csrf_token %}
<div class="modal-header"><h5>Add Transaction Head</h5></div>
<div class="modal-body">

<input name="tran_head_name" class="form-control mb-2" placeholder="Item Name" required>

<select name="groupe" class="form-control mb-2" required>
<option value="">Select Groupe</option>{% for g in groupes %}<option value="{{g.id}}">{{g.tran_groupe_name}}</option>{% endfor %}
</select>

<select name="category" class="form-control mb-2"><option value="">Category</option>{% for c in cats %}<option value="{{c.id}}">{{c.name}}</option>{% endfor %}</select>
<select name="manufacturer" class="form-control mb-2"><option value="">Manufacturer</option>{% for m in mans %}<option value="{{m.id}}">{{m.name}}</option>{% endfor %}</select>
<select name="form" class="form-control mb-2"><option value="">Form</option>{% for f in forms %}<option value="{{f.id}}">{{f.name}}</option>{% endfor %}</select>
<select name="unit" class="form-control mb-2" required>{% for u in units %}<option value="{{u.id}}">{{u.name}}</option>{% endfor %}</select>

<input name="quantity" class="form-control mb-2" placeholder="Qty" required>
<input name="cp" class="form-control mb-2" placeholder="Cost Price" required>
<input name="mrp" class="form-control mb-2" placeholder="MRP" required>
<input type="date" name="expiry_date" class="form-control mb-2">

<select name="editable" class="form-control mb-2">
<option value="1">Editable</option><option value="0">Fixed</option>
</select>

<select name="company" class="form-control mb-2">
<option value="">Select Company</option>{% for c in companies %}<option value="{{c.company_id}}">{{c.company_id}}</option>{% endfor %}
</select>

</div>
<div class="modal-footer">
<button class="btn btn-primary">Save</button>
</div>
</form>
</div></div></div>

<div class="modal fade" id="editModal">
<div class="modal-dialog modal-lg"><div class="modal-content">
<form id="editForm">{% csrf_token %}
<input type="hidden" name="id" id="edit_id">

<div class="modal-header"><h5>Edit Transaction Head</h5></div>
<div class="modal-body">

<input name="tran_head_name" id="edit_tran_head_name" class="form-control mb-2">

<select name="groupe" id="edit_groupe" class="form-control mb-2" required>
{% for g in groupes %}<option value="{{g.id}}">{{g.tran_groupe_name}}</option>{% endfor %}
</select>

<select name="category" id="edit_category" class="form-control mb-2">
<option value="">Category</option>{% for c in cats %}<option value="{{c.id}}">{{c.name}}</option>{% endfor %}
</select>

<select name="manufacturer" id="edit_manufacturer" class="form-control mb-2">
<option value="">Manufacturer</option>{% for m in mans %}<option value="{{m.id}}">{{m.name}}</option>{% endfor %}
</select>

<select name="form" id="edit_form" class="form-control mb-2">
<option value="">Form</option>{% for f in forms %}<option value="{{f.id}}">{{f.name}}</option>{% endfor %}
</select>

<select name="unit" id="edit_unit" class="form-control mb-2" required>
{% for u in units %}<option value="{{u.id}}">{{u.name}}</option>{% endfor %}
</select>

<input name="quantity" id="edit_quantity" class="form-control mb-2">
<input name="cp" id="edit_cp" class="form-control mb-2">
<input name="mrp" id="edit_mrp" class="form-control mb-2">
<input type="date" name="expiry_date" id="edit_expiry_date" class="form-control mb-2">

<select name="editable" id="edit_editable" class="form-control mb-2">
<option value="1">Editable</option>
<option value="0">Fixed</option>
</select>

<select name="company" id="edit_company" class="form-control mb-2">
<option value="">Select Company</option>
{% for c in companies %}<option value="{{c.company_id}}">{{c.company_id}}</option>{% endfor %}
</select>

</div>
<div class="modal-footer">
<button class="btn btn-primary">Update</button>
</div>
</form>
</div></div></div>


{% endblock %}
{% block extra_js %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
<script src="{% static 'js/transaction_heads/transaction_head.js' %}"></script>
{% endblock %}
